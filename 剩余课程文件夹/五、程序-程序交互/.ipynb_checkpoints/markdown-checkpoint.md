# 与操作系统对接的IO

## unixIO
unix文件基本属性：  
1. 文件内容：一系列字节序列
2. 进程对文件的处理：
<img src="markdown图片/屏幕截图 2024-01-15 111820.png" alt="图片alt" title="图片title"><br>
**在进程对文件的处理中，依然是内核控制着文件的各种属性**

文件类型：  
普通文件，目录，socket等  
另外，不在本课程中讲述的还有：通道文件，符号链接，外接设备等。<br>

## 1.普通文件
普通文件的高层分类：指的是每一个存储的字节的含义，这个含义不是在操作系统层面，而是在存储的内容是什么的层面，
<img src="markdown图片/屏幕截图 2024-01-15 184417.png" alt="图片alt" title="图片title"><br>
基于存储字节的含义不同，文本文件中这些字节只包含ascii和unicode编码（即其他的非这些编码的字节不存在）。二进制文件这些字节包含所有可能的值，例如图像文件等。

## 2.目录文件
<img src="markdown图片/屏幕截图 2024-01-15 185535.png" alt="图片alt" title="图片title"><br>
每个目录文件都至少包含它自身和它的父类的地址。

文件层次架构：<br>
<img src="markdown图片/屏幕截图 2024-01-16 121429.png" alt="图片alt" title="图片title"><br>
cwd:current work directory,图中显示了当前工作目录下寻找另一目录的方式。

## 3.低级unix文件操作
1. 进程中打开文件等操作：  
   见程序代码<br>
   **文件描述符：**<br>
   用于在某一进程中标识所打开的文件。<br>
   另外，linux打开的进程中，默认0，1，2分别代表stdin，stdout，stderr。
2. 注意关闭文件也会有错误，尤其是**多线程程序中的情况**。
3. 读文件，**注意，读文件后才是把文件描述符所指定的文件读入内存**
<img src="markdown图片/屏幕截图 2024-01-19 214201.png" alt="图片alt" title="图片title"><br>
另外，它读取位置从当前文件的文件位置开始（存储于内核态中），读取一定数量字节后，更新该文件位置。<br>
**不足值：指读取的字节数量小于最后能返回的字节数量。**  
写文件同样，也有上述不足值。